<div class="auth-page">
  <div class="auth-card">
    <div class="auth-card__header">
      <h1 class="auth-card__title">Recuperar contraseña</h1>
    </div>

    <!-- Mensaje de éxito -->
    @if (success()) {
      <div class="auth-card__alert auth-card__alert--success" role="status">
        ✅ Revisa tu bandeja de entrada. Te hemos enviado un enlace para
        restablecer tu contraseña.
      </div>
    }

    <!-- Error del servidor -->
    @if (serverError()) {
      <div class="auth-card__alert auth-card__alert--error" role="alert">
        {{ serverError() }}
      </div>
    }

    @if (!success()) {
      <p class="auth-card__description">
        Introduce tu email y te enviaremos instrucciones para restablecer tu
        contraseña.
      </p>

      <form (submit)="onSubmit(); $event.preventDefault()" novalidate>
        <!-- Email -->
        <div class="form-group">
          <label for="fp-email" class="form-group__label">Email</label>
          <input
            id="fp-email"
            type="email"
            class="input"
            autocomplete="email"
            placeholder="tu@email.com"
            [value]="email()"
            (input)="updateField(email, $event)"
            (blur)="emailTouched.set(true)"
            [attr.aria-invalid]="emailTouched() && emailError() ? 'true' : null"
            [attr.aria-describedby]="emailTouched() && emailError() ? 'fp-email-error' : null" />
          @if (emailTouched() && emailError()) {
            <span id="fp-email-error" class="form-error" role="alert">
              {{ emailError() }}
            </span>
          }
        </div>

        <!-- Tenant ID (opcional) -->
        <div class="form-group">
          <label for="fp-tenant" class="form-group__label">
            Tenant ID <span class="form-group__optional">(opcional)</span>
          </label>
          <input
            id="fp-tenant"
            type="text"
            class="input"
            placeholder="ID del restaurante"
            [value]="tenantId()"
            (input)="updateField(tenantId, $event)" />
        </div>

        <button
          type="submit"
          class="btn btn--primary auth-card__submit"
          [disabled]="loading()">
          @if (loading()) {
            <span class="spinner" aria-hidden="true"></span>
            Enviando…
          } @else {
            Enviar instrucciones
          }
        </button>
      </form>
    }

    <nav class="auth-card__links" aria-label="Navegación de autenticación">
      <a routerLink="/auth/login" class="auth-card__link">
        Volver al inicio de sesión
      </a>
    </nav>
  </div>
</div>
